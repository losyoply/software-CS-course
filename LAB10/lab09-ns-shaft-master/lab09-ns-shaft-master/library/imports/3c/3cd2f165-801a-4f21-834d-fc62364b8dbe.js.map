{"version":3,"sources":["assets\\Scripts\\Player.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameMgr from \"./GameMgr\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Player extends cc.Component \n{\n    @property()\n    playerSpeed: number = 300;\n\n    @property()\n    playerStandSpeed: number = 50;\n\n    @property({type:cc.AudioClip})\n    nailSound: cc.AudioClip = null;\n\n    @property({type:cc.AudioClip})\n    dieSound: cc.AudioClip = null;\n\n    @property(cc.Node)\n    gameMgr: cc.Node = null;\n    \n    private idleFrame: cc.SpriteFrame = null;\n\n    private anim: cc.Animation = null;\n\n    private moveDir = 0;\n\n    private ceilingPos: number = 155;\n\n    private fallDown: boolean = false;\n\n    private damageTime: number = 0;\n\n    start () {\n        this.idleFrame = this.getComponent(cc.Sprite).spriteFrame;\n        this.anim = this.getComponent(cc.Animation);\n    }\n\n    update(dt)\n    {\n        this.node.x += this.playerSpeed * this.moveDir * dt;\n        this.node.scaleX = (this.moveDir >= 0) ? 1 : -1;\n        this.node.y = (this.node.y >= this.ceilingPos) ? this.ceilingPos : this.node.y;\n        if(this.getComponent(cc.RigidBody).linearVelocity.y != this.playerStandSpeed)\n            this.fallDown = true;\n        else\n            this.fallDown = false;\n\n        if(this.damageTime > 0)\n            this.damageTime -= dt;\n        else\n            this.damageTime = 0;\n\n        this.playerAnimation();\n    }\n\n    reborn(rebornPos: cc.Vec2)\n    {\n        this.damageTime = 0;\n        this.node.position = rebornPos;\n        this.getComponent(cc.RigidBody).linearVelocity = cc.v2();\n    }\n\n    playerMove(moveDir: number)\n    {\n        this.moveDir = moveDir;\n    }\n\n    playerRecover()\n    {\n        this.gameMgr.getComponent(\"GameMgr\").updateLife(1);\n    }\n\n    playerDamage()\n    {\n        this.damageTime = 1;\n        cc.audioEngine.playEffect(this.nailSound, false);\n        this.gameMgr.getComponent(\"GameMgr\").updateLife(-5);\n    }\n\n    playerDie()\n    {\n        cc.audioEngine.playEffect(this.dieSound,false);\n        this.gameMgr.getComponent(\"GameMgr\").updateLife(-12);\n    }\n\n    playerAnimation()\n    {\n        if(this.fallDown)\n        {\n            if(this.damageTime > 0)\n            {\n                if(this.moveDir == 0 && !this.anim.getAnimationState(\"fall_front_hurt\").isPlaying)\n                    this.anim.play(\"fall_front_hurt\");\n                else if(this.moveDir != 0 && !this.anim.getAnimationState(\"fall_side_hurt\").isPlaying)\n                    this.anim.play(\"fall_side_hurt\");\n            }\n            else\n            {\n                if(this.moveDir == 0 && !this.anim.getAnimationState(\"fall_front\").isPlaying)\n                    this.anim.play(\"fall_front\");\n                else if(this.moveDir != 0 && !this.anim.getAnimationState(\"fall_side\").isPlaying)\n                    this.anim.play(\"fall_side\");\n            }\n        }\n        else\n        {\n            if(this.damageTime > 0)\n            {\n                if(this.moveDir == 0 && !this.anim.getAnimationState(\"idle_hurt\").isPlaying)\n                    this.anim.play(\"idle_hurt\");\n                else if(this.moveDir != 0 && !this.anim.getAnimationState(\"walk_hurt\").isPlaying)\n                    this.anim.play(\"walk_hurt\");\n            }\n            else\n            {\n                if(this.moveDir == 0)\n                {\n                    this.anim.stop();\n                    this.getComponent(cc.Sprite).spriteFrame = this.idleFrame;\n                }\n                else if(!this.anim.getAnimationState(\"walk\").isPlaying)\n                    this.anim.play(\"walk\");\n            }\n        }\n    }\n\n    onBeginContact(contact, selfCollider, otherCollider)\n    {\n        if(otherCollider.node.name == \"lowerBound\")\n        {\n            this.playerDie();\n        }\n        else if(otherCollider.node.name == \"ceiling\")\n        {\n            cc.log(\"player contact\");\n            this.playerDamage();\n        }\n\n    }\n}\n"]}